(function(){var d={name:"localStorage",init:function(){if(!window.localStorage)return!1;this._storage=window.localStorage;return this},setStorage:function(a,b){this._storage.setItem(a,b);return!0},getStorage:function(a,b){var c=this._storage.getItem(a);b(c?c:null)},removeStorage:function(a){this._storage.removeItem(a);return!0},clearStorage:function(){if(this._storage.clear)this._storage.clear();else for(i in this._storage)this._storage[i].value&&this.remove(i);return!0}},e={name:"globalStorage",
init:function(){if(!Browser.firefox||!window.globalStorage)return!1;this._storage=globalStorage[location.hostname];return this},setStorage:function(a,b){this._storage.setItem(a,b);return!0},getStorage:function(a,b){var c=this._storage.getItem(a);b(c?c.value:null)},removeStorage:function(a){this._storage.removeItem(a);return!0},clearStorage:function(){if(this._storage.clear)this._storage.clear();else for(i in this._storage)this._storage[i].value&&this.remove(i);return!0}},f={name:"userdata",init:function(){this.Master=
"ie6+";if(!Browser.ie)return!1;this._storage=(new Element("span")).setStyles({display:"none",behavior:"url('#default#userData')"}).inject(document.body);return this},setStorage:function(a,b){this._storage.setAttribute(a,b);this._storage.save("shopEX_VS");return!0},getStorage:function(a,b){this._storage.load("shopEX_VS");b(this._storage.getAttribute(a))},removeStorage:function(a){this._storage.removeAttribute(a);this._storage.save("shopEX_VS");return!0},clearStorage:function(){var a=new Date;a.setMinutes(a.getMinutes()-
1);this._storage.expires=a.toUTCString();this._storage.save("shopEX_VS");this._storage.load("shopEX_VS");return!0}},h={name:"openDatabase",init:function(){if(!window.openDatabase)return!1;this._storage=window.openDatabase("viewState","1.0","ShopEX48 ViewState Storage",2E4);this._createTable();return this},setStorage:function(a,b){this._storage.transaction(function(c){c.executeSql("SELECT v FROM SessionStorage WHERE k = ?",[a],function(c,g){g.rows.length?c.executeSql("UPDATE SessionStorage SET v = ?  WHERE k = ?",
[b,a]):c.executeSql("INSERT INTO SessionStorage (k, v) VALUES (?, ?)",[a,b])})});return!0},getStorage:function(a,b){this._storage.transaction(function(c){v=c.executeSql("SELECT v FROM SessionStorage WHERE k = ?",[a],function(a,c){if(c.rows.length)return b(c.rows.item(0).v);b(null)})})},removeStorage:function(a){this._storage.transaction(function(b){b.executeSql("DELETE FROM SessionStorage WHERE k = ?",[a])});return!0},clearStorage:function(){this._storage.transaction(function(a){a.executeSql("DROP TABLE SessionStorage",
[])});return!0},_createTable:function(){this._storage.transaction(function(a){a.executeSql("SELECT COUNT(*) FROM SessionStorage",[],function(){},function(a){a.executeSql("CREATE TABLE SessionStorage (k TEXT, v TEXT)",[],function(){})})})}},j={setStorage:function(){},getStorage:function(){},removeStorage:function(){},clearStorage:function(){}};BrowserStore=new Class({initialize:function(){this.storage=h.init()||e.init()||d.init()||f.init()||j;return this},set:function(a,b){b&&"string"===typeOf(b)&&
this.storage.setStorage(a,b);return this},get:function(a,b){this.storage.getStorage(a,b)},remove:function(a){if(!a||!this.storage)return!1;a&&this.storage.removeStorage(a);return this},clear:function(){if(!this.storage)return!1;this.storage.clearStorage();return this}})})();